<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Elifoot Web</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0b6623;
  color: white;
  text-align: center;
}

button {
  padding: 10px 18px;
  margin: 6px;
  font-size: 16px;
  cursor: pointer;
}

.hidden {
  display: none;
}

table {
  margin: 15px auto;
  border-collapse: collapse;
}

td, th {
  border: 1px solid white;
  padding: 6px 10px;
}

.highlight {
  background: #ffd700;
  color: black;
}
</style>
</head>

<body>

<h1>‚öΩ ELIFOOT WEB</h1>

<!-- SELE√á√ÉO -->
<div id="screen-select" class="hidden">
  <h2>Escolha seu time</h2>
</div>

<!-- JOGO -->
<div id="screen-game" class="hidden">
  <h2 id="myTeam"></h2>
  <p>
    Rodada <span id="round"></span> /
    <span id="totalRounds"></span>
  </p>

  <button onclick="playRound()">‚ñ∂ Jogar Rodada</button>
  <button onclick="showTable()">üìä Classifica√ß√£o</button>
  <button onclick="newGame()">üÜï Novo Jogo</button>

  <div id="output"></div>
</div>

<script>
/* ================== STORAGE ================== */
const STORAGE_KEY = "elifoot-save";

/* ================== DADOS ================== */
let myTeam = "";
let currentRound = 0;
let schedule = [];

let teams = [
  { name: "Sparta FC", pts: 0, gf: 0, ga: 0 },
  { name: "Roma FC", pts: 0, gf: 0, ga: 0 },
  { name: "Athenas FC", pts: 0, gf: 0, ga: 0 },
  { name: "Troia FC", pts: 0, gf: 0, ga: 0 }
];

/* ================== SEASON ================== */
function generateSeason(teamList) {
  const matches = [];

  for (let i = 0; i < teamList.length; i++) {
    for (let j = i + 1; j < teamList.length; j++) {
      matches.push({ home: teamList[i].name, away: teamList[j].name });
    }
  }

  const returnMatches = matches.map(m => ({
    home: m.away,
    away: m.home
  }));

  return matches.concat(returnMatches);
}

/* ================== SAVE / LOAD ================== */
function saveGame() {
  const data = {
    myTeam,
    currentRound,
    teams,
    schedule
  };
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

function loadGame() {
  const data = localStorage.getItem(STORAGE_KEY);
  if (!data) return false;

  const save = JSON.parse(data);
  myTeam = save.myTeam;
  currentRound = save.currentRound;
  teams = save.teams;
  schedule = save.schedule;
  return true;
}

/* ================== UI ================== */
const selectDiv = document.getElementById("screen-select");
const gameDiv = document.getElementById("screen-game");

function setupSelection() {
  selectDiv.innerHTML = "<h2>Escolha seu time</h2>";

  teams.forEach(t => {
    const btn = document.createElement("button");
    btn.innerText = t.name;
    btn.onclick = () => startGame(t.name);
    selectDiv.appendChild(btn);
  });
}

/* ================== START ================== */
function startGame(teamName) {
  myTeam = teamName;
  schedule = generateSeason(teams);
  currentRound = 0;

  showGame();
  saveGame();
}

function showGame() {
  selectDiv.classList.add("hidden");
  gameDiv.classList.remove("hidden");

  document.getElementById("myTeam").innerText = "Seu time: " + myTeam;
  document.getElementById("round").innerText = currentRound + 1;
  document.getElementById("totalRounds").innerText = schedule.length;
}

/* ================== GAME ================== */
function playRound() {
  if (currentRound >= schedule.length) {
    finishSeason();
    return;
  }

  const match = schedule[currentRound];
  const home = teams.find(t => t.name === match.home);
  const away = teams.find(t => t.name === match.away);

  const gh = Math.floor(Math.random() * 4);
  const ga = Math.floor(Math.random() * 4);

  home.gf += gh; home.ga += ga;
  away.gf += ga; away.ga += gh;

  if (gh > ga) home.pts += 3;
  else if (ga > gh) away.pts += 3;
  else { home.pts++; away.pts++; }

  document.getElementById("output").innerHTML = `
    <h3>Rodada ${currentRound + 1}</h3>
    <p>${home.name} ${gh} x ${ga} ${away.name}</p>
  `;

  currentRound++;
  document.getElementById("round").innerText =
    Math.min(currentRound + 1, schedule.length);

  saveGame();
}

/* ================== TABLE ================== */
function showTable() {
  let html = `
    <h3>Classifica√ß√£o</h3>
    <table>
      <tr>
        <th>Time</th>
        <th>Pts</th>
        <th>GM</th>
        <th>GS</th>
      </tr>
  `;

  teams
    .slice()
    .sort((a, b) => b.pts - a.pts)
    .forEach(t => {
      const cls = t.name === myTeam ? "highlight" : "";
      html += `
        <tr class="${cls}">
          <td>${t.name}</td>
          <td>${t.pts}</td>
          <td>${t.gf}</td>
          <td>${t.ga}</td>
        </tr>
      `;
    });

  html += "</table>";
  document.getElementById("output").innerHTML = html;
}

/* ================== END ================== */
function finishSeason() {
  const champion = teams
    .slice()
    .sort((a, b) => b.pts - a.pts)[0];

  document.getElementById("output").innerHTML = `
    <h2>üèÜ Fim da Temporada</h2>
    <p>Campe√£o: <strong>${champion.name}</strong></p>
  `;

  localStorage.removeItem(STORAGE_KEY);
}

/* ================== NEW GAME ================== */
function newGame() {
  localStorage.removeItem(STORAGE_KEY);
  location.reload();
}

/* ================== INIT ================== */
if (loadGame()) {
  showGame();
} else {
  setupSelection();
  selectDiv.classList.remove("hidden");
}
</script>

</body>
</html>
