<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Elifoot Web</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0b6623;
  color: white;
  text-align: center;
}

button {
  padding: 8px 16px;
  margin: 5px;
  font-size: 15px;
  cursor: pointer;
}

.hidden { display: none; }

table {
  margin: 15px auto;
  border-collapse: collapse;
}

td, th {
  border: 1px solid white;
  padding: 6px 10px;
}

.highlight {
  background: gold;
  color: black;
}
</style>
</head>

<body>

<h1>‚öΩ ELIFOOT WEB</h1>

<!-- SELE√á√ÉO -->
<div id="screen-select">
  <h2>Escolha seu time</h2>
</div>

<!-- JOGO -->
<div id="screen-game" class="hidden">
  <h2 id="teamName"></h2>
  <p>üí∞ Dinheiro: $<span id="money"></span></p>
  <p>Rodada <span id="round"></span> / <span id="totalRounds"></span></p>

  <button onclick="playRound()">‚ñ∂ Jogar Rodada</button>
  <button onclick="showTable()">üìä Classifica√ß√£o</button>
  <button onclick="showMarket()">üí∏ Mercado</button>
  <button onclick="newGame()">üÜï Novo Jogo</button>

  <div id="output"></div>
</div>

<script>
/* ================== STORAGE ================== */
const KEY = "elifoot-save";

/* ================== TIMES ================== */
let teams = [
  { name: "Sparta FC", pts: 0, gf: 0, ga: 0, strength: 75 },
  { name: "Roma FC", pts: 0, gf: 0, ga: 0, strength: 70 },
  { name: "Athenas FC", pts: 0, gf: 0, ga: 0, strength: 65 },
  { name: "Troia FC", pts: 0, gf: 0, ga: 0, strength: 60 }
];

/* ================== JOGADOR ================== */
let myTeam = "";
let money = 100;
let currentRound = 0;
let schedule = [];

/* ================== TEMPORADA ================== */
function generateSeason() {
  let games = [];
  for (let i = 0; i < teams.length; i++) {
    for (let j = i + 1; j < teams.length; j++) {
      games.push({ h: teams[i].name, a: teams[j].name });
      games.push({ h: teams[j].name, a: teams[i].name });
    }
  }
  return games;
}

/* ================== SAVE / LOAD ================== */
function saveGame() {
  localStorage.setItem(KEY, JSON.stringify({
    teams, myTeam, money, currentRound, schedule
  }));
}

function loadGame() {
  const data = localStorage.getItem(KEY);
  if (!data) return false;

  const save = JSON.parse(data);
  teams = save.teams;
  myTeam = save.myTeam;
  money = save.money;
  currentRound = save.currentRound;
  schedule = save.schedule;
  return true;
}

/* ================== START ================== */
const selectDiv = document.getElementById("screen-select");
const gameDiv = document.getElementById("screen-game");

function setupSelection() {
  teams.forEach(t => {
    const btn = document.createElement("button");
    btn.innerText = t.name;
    btn.onclick = () => startGame(t.name);
    selectDiv.appendChild(btn);
  });
}

function startGame(team) {
  myTeam = team;
  schedule = generateSeason();
  currentRound = 0;
  showGame();
  saveGame();
}

function showGame() {
  selectDiv.classList.add("hidden");
  gameDiv.classList.remove("hidden");

  document.getElementById("teamName").innerText = "Seu time: " + myTeam;
  document.getElementById("money").innerText = money;
  document.getElementById("round").innerText = currentRound + 1;
  document.getElementById("totalRounds").innerText = schedule.length;
}

/* ================== PARTIDA ================== */
function playRound() {
  if (currentRound >= schedule.length) {
    finishSeason();
    return;
  }

  const m = schedule[currentRound];
  const h = teams.find(t => t.name === m.h);
  const a = teams.find(t => t.name === m.a);

  const gh = Math.floor(Math.random() * (h.strength / 20));
  const ga = Math.floor(Math.random() * (a.strength / 20));

  h.gf += gh; h.ga += ga;
  a.gf += ga; a.ga += gh;

  if (gh > ga) h.pts += 3;
  else if (ga > gh) a.pts += 3;
  else { h.pts++; a.pts++; }

  if (h.name === myTeam || a.name === myTeam) {
    money += gh > ga && h.name === myTeam ? 10 : 5;
  }

  document.getElementById("output").innerHTML = `
    <h3>Rodada ${currentRound + 1}</h3>
    <p>${h.name} ${gh} x ${ga} ${a.name}</p>
  `;

  currentRound++;
  document.getElementById("round").innerText =
    Math.min(currentRound + 1, schedule.length);

  document.getElementById("money").innerText = money;
  saveGame();
}

/* ================== MERCADO ================== */
function showMarket() {
  let html = "<h3>üí∏ Mercado de Transfer√™ncias</h3>";

  teams.forEach(t => {
    if (t.name !== myTeam) {
      const price = Math.floor(t.strength * 1.5);
      html += `
        <p>
          ${t.name} | For√ßa: ${t.strength} | üí∞ $${price}
          <button onclick="buyTeam('${t.name}', ${price})">Comprar</button>
        </p>
      `;
    }
  });

  document.getElementById("output").innerHTML = html;
}

function buyTeam(name, price) {
  if (money < price) {
    alert("Dinheiro insuficiente!");
    return;
  }

  const my = teams.find(t => t.name === myTeam);
  const target = teams.find(t => t.name === name);

  my.strength += 5;
  target.strength -= 5;
  money -= price;

  document.getElementById("money").innerText = money;
  alert("Transfer√™ncia realizada!");
  saveGame();
}

/* ================== CLASSIFICA√á√ÉO ================== */
function showTable() {
  let html = `
  <table>
    <tr><th>Time</th><th>Pts</th><th>For√ßa</th></tr>
  `;

  teams.slice().sort((a,b)=>b.pts-a.pts).forEach(t=>{
    html += `
    <tr class="${t.name===myTeam?'highlight':''}">
      <td>${t.name}</td>
      <td>${t.pts}</td>
      <td>${t.strength}</td>
    </tr>`;
  });

  html += "</table>";
  document.getElementById("output").innerHTML = html;
}

/* ================== FIM ================== */
function finishSeason() {
  const champ = teams.slice().sort((a,b)=>b.pts-a.pts)[0];
  document.getElementById("output").innerHTML = `
    <h2>üèÜ Campe√£o: ${champ.name}</h2>
  `;
  localStorage.removeItem(KEY);
}

function newGame() {
  localStorage.removeItem(KEY);
  location.reload();
}

/* ================== INIT ================== */
if (loadGame()) showGame();
else setupSelection();
</script>

</body>
</html>
